language: cpp
compiler:
- gcc
env:
  matrix:
  - NODE_NVM_VERSION="0.10"
  - NODE_NVM_VERSION="0.8"
  global:
  - node_pre_gyp_accessKeyId: AKIAJX3FGRA7TJMHQD2Q
  - secure: "AGr8ddjsQIeKk1zR/NxkRUqV2JMl9T+yrUqyJY3mS2Gj1i+kfuNrqn47jh8gz85ESfdrm+Pf3ulgrC3GzXKKKT5mHeR+uFr3Biikg1YYQVaps3IF7/f6qDpTMvfWkXEyoakHyT252+M9wDZFxHTVdWuy0e/1y63eDfYQRl3JocI="
before_install:
- export platform=$(uname -s | sed "y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/")
- if [[ "$platform" == "linux" ]]; then sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test; sudo apt-get update; sudo apt-get install gcc-4.8 g++-4.8; export CXX=g++-4.8; fi
- if [[ "$platform" == 'darwin' ]]; then brew install jpeg-turbo libpng; fi
- git clone https://github.com/creationix/nvm.git ../.nvm
- source ../.nvm/nvm.sh
- nvm install $NODE_NVM_VERSION
- nvm use $NODE_NVM_VERSION
- node --version
- npm --version
- sudo ./test/travis-protobuf.sh
install:
- npm install
script:
- npm test
after_success:
- ./test/travis-publish.sh
